<!--StartFragment-->

前言

这次的事件，是资本的胜利，而不是用户的，对于行业发展更是一种倒退。

比特币向左，Sui 向右，每一个动摇去中心化的行业举动出现，都带来更强烈对比特币的信仰。

世界需要的不只是一套更好的全球化金融基础设施，而是始终都会有一群人需要自由的空间。

曾几何时，联盟链是比公链更红火的存在，就是因为他满足那个时代的监管需求，如今联盟的式微，其实也就是意味着单纯遵从此需求，并不是真实用户的需求，**失去的被监管的用户，那又需监管工具呢？**

## 1、事件背景

2025 年 5 月 22 日，Sui 公链生态的最大去中心化交易所 (DEX) Cetus 遭遇黑客攻击，瞬间流动性骤减，多种交易对价格崩塌，损失超过 2.2 亿美元。

截止发稿前，时间线如下：

* 5 月 22 日上午,黑客攻击 Cetus 套取 2.3 亿美元, Cetus 紧急暂停合约，发布公告
* 5 月 22 日 下午,黑客跨链转出约 6000 万美元，其余 1.62 亿美元仍在 Sui 链上地址中, Sui 验证节点迅速采取行动，将黑客地址加入“拒绝服务黑名单（Deny List）”，冻结资金
* 5 月 22 日晚间, Sui CPO @emanabio 发推确认：资金已被冻结、归还将很快开始
* 5 月 23 日, Cetus 开始修复漏洞并更新合约
* 5 月 24 日, Sui 开源 PR，解释即将通过别名机制（aliasing）与 whitelist 进行资金回收
* 5 月 26 日, Sui 启动链上治理投票，提议是否执行协议升级、将黑客资产转至托管地址
* 5 月 29 日,投票结果公布，超过 2/3 验证节点权重支持；协议升级准备执行
* 5 月 30 日-6 月初,协议升级生效，指定交易哈希被执行，黑客资产被“合法转走”

<br>


## 2、攻击原理

事件原理相关，行业已经有多篇表述，在此仅做核心原理概览：

<br>


**从攻击流程上看：**

攻击者首先利用闪电贷借出约 10, 024, 321.28 个 haSUI，瞬间将交易池的价格下跌了

99.90% 。这一巨额卖单使得目标池价格从约 1.8956 × 10 ^ 19 降至 1.8425 × 10 ^ 19 ，几乎见底清空。

随后，攻击者在 Cetus 上以极窄的区间（Tick 下限 300000、上限 300200 ，区间宽度仅 1.00496621% ）创建流动性头寸。如此窄的区间放大了后续计算误差对所需代币数量的影响。

<br>


**而攻击核心原理：**

在于 Cetus 用于计算所需代币数量的 get_delta_a 函数中存在整数溢出漏洞。攻击者故意声明要添加一个巨大流动性（约 10 ^ 37 单位），但实际只向合约中投入 1 个代币。

由于 checked_shlw 的溢出检测条件错误，合约在左移计算时发生了高位截断，使得系统严重低估了所需的 haSUI 数量，从而以极小成本换取了巨量流动性。

从技术上看，上述漏洞源于 Cetus 在 Move 智能合约中使用了错误的掩码和判断条件，导致任何小于 0xffffffffffffffff << 192 的值都能绕过检测；而左移 64 位后高位数据被截断，系统仅收取极少代币就认为获得了巨大流动性。

在事件发生后，衍生出 2 个官方操作：**“冻结” vs “追回” ，他是两个阶段**：

* 冻结阶段靠 Deny List + 节点共识完成；
* 追回阶段则需链上协议升级 + 社区投票 + 指定交易执行绕过黑名单。

<br>


## 3、Sui 的冻结机制

Sui 链内本身就存在特殊的 Deny List (拒绝列表)机制，实现了本次黑客资金冻结。不止如此，其实 Sui 的代币标准也有“**受监管代币**”模式，带有内置冻结功能。

此次应急冻结正是利用了这一特性：验证者节点在本地配置文件中快速添加了被盗资金相关的地址。理论上每个节点运营者都可以自行修改 TransactionDenyConfig 来更新黑名单，**但为了确保网络一致性，Sui 基金会作为最初的配置发布方进行了集中协调。**

基金会首先官方发布了含黑客地址的配置更新，验证者按默认配置同步生效，从而让黑客资金在链上**暂时被“封印”**，这背后实际上存在高度的集中化因素

为了从冻结资金中解救受害者，Sui 团队紧接着推出了**白名单 (Whitelist) **机制补丁。

这是针对后续转回资金的操作的。可以事先构造好合法交易并登记在白名单中，即便该资金地址还在黑名单上，也能强制执行。

这个新的特性 transaction_allow_list_skip_all_checks 允许将特定交易预先加入“免检名单”，使这些交易可以跳过所有安全检查，包括签名、权限、黑名单等。

**要注意的是，白名单补丁并不能直接抢走黑客资产**；它只是赋予某些交易绕开冻结的能力，真正的资产转移仍需合法签名或额外系统权限模块来完成。

其实，行业主流的冻结方案往往发生在代币合约层面，且由发行方多签控制。

以 Tether 发行的 USDT 为例，其合约内置黑名单函数，发行公司可将违规地址冻结，使其无法转移 USDT。这种方案需要多重签名在链上发起冻结请求，多签达成一致后才真正执行，因而存在执行延迟。

Tether 冻结机制虽然有效，但统计表明多签流程常会出现“空窗期”，给不法分子留下可乘之机。

相比之下，Sui 的冻结发生在底层协议级别，由验证者节点集体操作，执行速度远快于普通合约调用。

这套模式下，要执行得够快，**就要意味着这些验证者节点本身的管理，就是高度统一的。**



## 4、Sui 的“转账式回收”实现原理 

更惊人的是，Sui 不仅冻结了黑客资产，还计划通过链上升级“转移回收”被盗资金。

5 月 27 日，Cetus 提出了社区投票方案，要求对协议进行升级，将被冻结的资金发送到多重签名托管钱包中。Sui 基金会随即发起链上治理投票。

5 月 29 日，公布投票结果，约 **90.9% ** 权重的验证者支持该方案。Sui 官方宣布，一旦提案通过，“所有在两个黑客账户中被冻结的资金将无需黑客签名而被一并收回到一个多签钱包”。

**无需黑客签名，这是多么差异的特征，从来区块链行业都没有这样的修复方式。**

从 Sui 官方的 GitHub PR 可知，协议引入了地址别名 (address aliasing) 机制。升级内容包括：在 ProtocolConfig 中预先指定别名规则，使得某些允许的交易可以将合法签名视作来自黑客账户发送。

具体来说，将要执行的救援交易哈希列表与目标地址（即黑客地址）绑定，任何签署并发布这些固定交易摘要的执行者都被视为有效的黑客地址拥有者发起了交易。对这些特定交易，验证者节点系统会绕过 Deny List 检查。

从代码层面看，Sui 在交易验证逻辑中加入了如下判断：当一笔交易被黑名单拦截后，系统遍历其签名者，检查 protocol_config.is_tx_allowed_via_aliasing(sender, signer, tx_digest) 是否为真。

只要存在某个签名者满足别名规则，即标记这笔交易被允许通过，便忽略之前的拦截错误，继续正常打包执行。

<br>


## 5、观点

**1.6 亿，撕开的是行业最深的底层信仰**

Cetus 事件，从笔者个人看来，这此或许风波会很快过去，但是这套模式不会遗忘，因为他颠覆了行业基础，也打破了区块链在同一套账本下，**不可篡改**的传统共识。

在区块链设计里，合约就是法律，代码就是裁判。

但这次事件中，代码失效，治理干预，权力凌驾，形成了投票行为裁决代码结果”的模式。

就是因为，Sui 此次直接挪用交易的做法，与主流区块链的处理黑客问题上有巨大差异。

<br>


**这不是第一次“篡改共识”，但却是最静默的一次**

从历史上看：

* 以太坊 2016 年 The DAO 事件曾通过硬分叉回滚转账来弥补损失，但这一决定导致了以太坊与以太坊经典两条链的分裂，过程备受争议，但是最终是由不同的群体形成不同的共识信仰。
* 比特币社区同样经历过类似技术挑战： 2010 年的价值溢出漏洞被开发者紧急修复并升级共识规则，彻底抹除了约 184 亿枚非法生成的比特币。

这都是同样的硬分叉模式，把账本回滚到问题之前，然后用户依旧可以自行决定在哪套账本体系下继续使用。

与 DAO 硬分叉相比，Sui 没有选择分裂链条，而是通过**协议升级加配置别名**的方式精准针对本次事件。这样做，Sui 保持了链的连续性和大部分共识规则不变，但同时也**表明底层协议可以被用来实施针对性的“救援行动”。**

问题就是，**历史上的“分叉式回滚”是用户选择信仰；Sui 的“协议式修正”是链替你做了决定。**

<br>

**Not Your Key, Not Your Coin？恐怕 Not Anymore.**

从长远看，这意味着 “**Not your keys, not your coins**” 的理念在 Sui 链上被瓦解：即便用户私钥完整，网络仍可通过集体协议变更来阻止资产流动并重定向资产。

如果这成为未来区块链应对大型安全事件的先例、乃至被认为是可以再次遵守的惯例。

“当一条链能为了正义打破规则，它也就有了打破任何规则的前例。”

**一旦有一次“公益抢钱”的成功，下次就可能是“道德模糊地带”的操作**

<br>


那会发生什么？

**黑客是确实偷了用户的钱，那么群体投票，就可以抢走他的钱吗？**

投票依据的是谁的钱多（pos）还是人多呢？钱多者胜利，那刘慈欣笔下的终产者将很快到来，如果是人多者胜利，那么群体乌合之众也就声浪迭起。

在传统制度下，非法所得不受保护是非常正常的，冻结与划转都是传统银行的常规操作。

**但是从技术理论上无法进行这点，不就是区块链行业的发展根源吗。**

现在行业合规的大棒在持续发酵，今天可以为了黑客冻结，修改账户余额，那明天可以为地缘因素、矛盾因素，去做任意的修改。如果链成为地区性的部分工具。

那行业的价值也就被大幅压缩，充其量就是另一套更不好用的金融系统而已。

这也是笔者坚定行业的原因：“区块链不是因为不能冻结才有价值，而是因为即便你恨它，它也不为你改变。”

<br>


监管大势所趋，链能否守住自己的灵魂？

曾几何时，联盟链是比公链更红火的存在，就是因为他满足那个时代的监管需求，如今联盟的式微，其实也就是意味着单纯遵从此需求，并不是真实用户的需求，**失去的被监管的用户，那又需监管工具呢**。

<br>

**从行业发展角度看**

高效的中心化”，它是区块链发展的必经阶段吗？如果去中心化的最终目标是保障用户利益，那我们能否容忍中心化作为过渡手段？”

“民主”这个词，在链上治理语境中，其实是**token weighted **的。那么黑客如果持有大量 SUI（或某天 DAO 被黑，黑客控制票权），**是否也可以“合法投票洗白自己”**？

最终，区块链的价值，不在于能不能冻结，而在于即便群体有能力冻结，也选择不这么做。

**一条链的未来，不由技术架构决定，而由它选择守护的那套信仰来决定。**

<br>



**【十四君-原创回顾】**




* [OKX 研究院 | 账户抽象 10 年演进终局之战，透过 EIP-7702 看过去与未来](https://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484542\&idx=1\&sn=98f1c088cba6c6c1622ca7002e52051f\&scene=21#wechat_redirect)
* [在香港嘉年华回望这三年：狂热、祛魅与穿越](https://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484517\&idx=1\&sn=564d9084f6e4b8554a22e79baa15b40b\&scene=21#wechat_redirect)
* [万字研报：Solana 上 MEV 的格局演进与是非功过](https://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484513\&idx=1\&sn=ff695734e62194e1ffe9ac4fa8707784\&scene=21#wechat_redirect)
* [超级中介还是商业奇才？ 再看跨链桥龙头 LayerZero 从V1到V2后的这一年](https://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484501\&idx=1\&sn=c927367b9e7d1b307c7dd111ee2f5c14\&scene=21#wechat_redirect)
* [【深度解读】今年最值得期待的以太坊布拉格升级](https://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484494\&idx=1\&sn=7a23d3748fcb34e54588fd49dc8f4ca2\&scene=21#wechat_redirect)
* [深度揭秘：是谁扼杀了 Telegram 小游戏的生机？](https://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484445\&idx=1\&sn=3a2613ba779083e95e82d59f62ea2573\&scene=21#wechat_redirect)

* [从 4337 到 7702 ：深入解读以太坊账号抽象赛道的过去与未来](http://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484371\&idx=1\&sn=6471a9d595efe296cfbffeff7fb0c15e\&chksm=e83aa409df4d2d1fa9fb5db3685f0c7450fc0edaf63613741bc14cb6591aedb99e538279a271\&scene=21#wechat_redirect)
* [以太坊合并一年后的 MEV 格局](http://mp.weixin.qq.com/s?\__biz=MzIyMTQ5MTg5Mw==\&mid=2247484223\&idx=1\&sn=1150ab17eb0e3a8c61ea51bf8fe87ea6\&chksm=e83aa4e5df4d2df3d85872128f4188ea3c5b65c2fbf17c283fd046e0de1ddb3d50acf585572a\&scene=21#wechat_redirect)

后台留言作者，探讨web3行业问题

点赞关注，十四用技术视角带给你价值

周更博主，推荐加星标减少漏过最新原创观点！

![](https://piccdn.0daily.com/202506/02060202/m848x19y5tr24h89.png)


<!--EndFragment-->
